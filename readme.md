# Документация для квестовой игры

## Установка проекта

### 1. Клонирование репозитория
```bash
git clone https://github.com/dioxsound/quest-novella.git
cd quest-novella
```

### 2. Установка зависимостей
```bash
python -m venv venv
source venv/bin/activate  # Для Linux/Mac
venv\Scripts\activate     # Для Windows
pip install -r requirements.txt
```

### 3. Настройка базы данных
1. Установите PostgreSQL и создайте базу данных.
2. Создайте файл `.env` в корне проекта:
```ini
SECRET_KEY=ваш_секретный_ключ
DATABASE_URL=postgresql://user:password@localhost/db_name
TINYMCE_API_KEY=ваш_ключ_от_tinymce
```

### 4. Применение миграций
```bash
flask db init
flask db migrate
flask db upgrade
```

## Запуск приложения
```bash
flask run
```
Приложение будет доступно по адресу: `http://localhost:5000`

## Настройка изображений
Создайте папку для загрузки изображений:
```bash
mkdir -p static/images
```

## Использование админ-панели
Доступ: `http://localhost:5000/admin`

### Работа со сценариями
1. **Создание**: Укажите текст (поддерживает HTML) и загрузите изображение
2. **Редактирование**: Измените содержимое через WYSIWYG-редактор
3. **Удаление**: Удаляет все связанные выборы

### Работа с выборами
1. Привязывайте выборы к сценариям через ID
2. Для завершения игры выберите "Конец игры"
3. Редактируйте связи между сценариями

## Особенности
- Переключение тем (светлая/тёмная) сохраняется в cookies
- Изображения автоматически ресайзятся до 800x600px
- Валидация форм на стороне сервера

## Возможные проблемы
1. **Нет доступа к изображениям**:
   - Проверьте права на папку `static/images`
   - Убедитесь что файл сохранён с правильным именем

2. **Ошибки базы данных**:
   - Пересоздайте миграции: `flask db migrate --message 'Initial'`
   - Проверьте подключение в `.env`

3. **Не работает редактор**:
   - Убедитесь что задан `TINYMCE_API_KEY`
   - Проверьте интернет-соединение
